<!DOCTYPE html>
<html lang="en">
  <meta charset="utf8" />
  <head>
    <title>测试</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <img src="http://localhost:3000/img" alt="" />
  <body>
    <script>
      /**
       * @param {string[]} chessboard
       * @return {number}
       */
      var flipChess = function(chessboard) {
        let sum = 0;
        chessboard.forEach((cell,index)=>{
          for(let i=0;i<cell.length;i++){
            if(cell[i]==='O'){
              sum++;
            }
          }
          chessboard[index] = cell.split('')
        })
        let max=0;
        for(let i=0;i<chessboard.length;i++){
          for(let j=0;j<chessboard[i].length;j++){
            if(max === sum){
              return sum;
            }
            let matrix = chessboard.slice()
            let offset = change(matrix,i,j)
            if(offset===0){
              continue;
            }
            let num = sum - offset;
            dp(matrix,num)
          }
        }
        return sum>max?sum:max;

        function change(matrix,x,y){
          if(matrix[x][y] === 'O'){
            return 0;
          }else if(matrix[x][y] === 'X'){
            return 0;
          }
          let sum=0
          for(let i=0;i<matrix[x].length;i++){
            if(matrix[x][i] === 'O'){
              sum++;
              matrix[x][i]='X'
            }
          }
          for(let j=0;j<matrix.length;j++){
            if(matrix[j][y] === 'O'){
              sum++;
              matrix[j][y]='X'
            }
          }
          // 对角线

          return sum;
        }
        function dp(matrix,num){
          if(num===0){
            max=sum;
            return;
          }
          max = Math.max(max,(sum-num))
          for(let i=0;i<matrix.length;i++){
            for(let j=0;j<matrix[i].length;j++){
              let matrixDp = matrix.slice()
              let offset  = change(matrixDp,i,j)
              if(offset===0){
                continue;
              }
              let numDp = sum - offset;
              dp(matrixDp,numDp)
            }
          }
        }
      };
      console.log(flipChess(["....X.","....X.","XOOO..","......","......"]))
    </script>
  </body>
</html>
