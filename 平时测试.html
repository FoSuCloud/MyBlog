
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>测试</title>
    <style type="text/css">
        body,html{
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
        }
    </style>

<body>

<script>
    // 使用WebSocket对象新建一个websocket连接
    var ws = new WebSocket("ws://localhost:3000/foo");
    // websocket连接开启后
    ws.onopen = function(evt) {
        console.log("Connection open ...");
        ws.send("Hello WebSockets!"); // 发送数据给服务器端
    };
    // 拿到websocket的响应后
    ws.onmessage = function(evt) {
        if(evt.data instanceof Blob){
            let reader = new FileReader();
            reader.onload = function(event){
                console.log(reader.result)
            };
            reader.readAsText(evt.data);
        }
        // ws.close(); // 前端主动去结束请求
    };

    // websocket请求的关闭后
    ws.onclose = function(evt) {
        console.log("Connection closed.");
    };
</script>
</body>

</html>
